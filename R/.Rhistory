dir.create('Rscripts')
getwd()
install.packages('readr')
install.packages('dplyr')
library(dplyr)
install.packages('tidyr')
list.files()
a <- 'a'
# clean working environment
rm(list = ls(all.names = T))
# clean working environment
rm(list = ls(all.names = T))
gc()
# load packages
library(readr)
# load packages
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(forcats)
ls
cd
###  load the QUAST result report .tsv file
quast_out <- read_tsv('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/', show_col_types = F)
###  load the QUAST result report .tsv file
quast_out <- read_tsv('\\wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/', show_col_types = F)
###  load the QUAST result report .tsv file
quast_out <- read_tsv('\\wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles', show_col_types = F)
###  load the QUAST result report .tsv file
quast_out <- read_tsv('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/quast_outfiles/report.tsv', show_col_types = F)
head(quast_out)
quast_out
print(quast_out n = 21)
print(quast_out, n = 21)
quast_out <- quast_out %>% rename(metric = Assembly,
value = Oocatochus_rufodorsatus_v1.asm.bp.p_ctg)
head(quast_out)
###  keep metrics of interest
key_metrics <- quast_out %>%
filter(metric %in% c('Total length', '# contigs', 'Largest contig', 'GC (%)', 'N50', 'N75', 'L50', 'L75'))
print(quast_out)
print(quast_out)
print(key_metrics)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel('metric', 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel('metric', 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric), color = 'black') +
geom_col(width = 0.6)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black')
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.2)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.1)
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.1) +
xlab('Metric') + ylab('Value (Mb)')
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.1) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic()
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic()
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none')
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
plot.background = element_rect())
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect())
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line())
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16),
axis.title = element_text(size = 20))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16),
axis.title = element_text(size = 19))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16),
axis.title = element_text(size = 19),
axis.title.x = element_text(margin = margin(t = 20)))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16),
axis.title = element_text(size = 19),
axis.title.x = element_text(margin = margin(t = 20)),
axis.title.y = element_text(margin = margin(l = 20)))
###  plot N50 and N75 // N50 is given in bp == use mutate() and divide up the raw value of N50 by 1e6 (10^6) to convert the value to Mb
quast_out %>%
filter(metric %in% c('N50', 'N75')) %>%
mutate(value_mb = value / 1e6,
metric = fct_relevel(metric, 'N50', 'N75')) %>%
ggplot(aes(x = metric, y = value_mb, fill = metric)) +
geom_col(width = 0.6, color = 'black', size = 1.0) +
xlab('Metric') + ylab('Value (Mb)') +
theme_classic() +
theme(legend.position = 'none',
panel.border = element_rect(fill = NA),
panel.grid.major = element_line(),
axis.text = element_text(size = 16),
axis.title = element_text(size = 19),
axis.title.x = element_text(margin = margin(t = 20)),
axis.title.y = element_text(margin = margin(r = 20)))
# load packages
library(stringr)
library(dplyr)
library(ggplot2)
list.files()
### load BUSCO results
busco <- readLines('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/short_summary.specific.sauropsida_odb10.Oocatochus_BUSCO.txt')
print(busco)
BiocManager::install("almeidasilvaf/cogeqc")
# load packages
library(cogeqc)
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/short_summary.specific.sauropsida_odb10.Oocatochus_BUSCO.txt')
result_dir <- system.file("extdata", package = "cogeqc")
result_dir
summary_df <- read_busco(result_dir)
summary_df
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/short_summary.specific.sauropsida_odb10.Oocatochus_BUSCO.txt')
getwd()
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('//wsl.localhost/Ubuntu/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/')
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/')
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/short_summary.specific.sauropsida_odb10.Oocatochus_BUSCO.txt')
list.files(ls)
list.files(ls)
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('/home/yshin/Oocatochus_genome_assembly/outfiles/busco_outfiles/Oocatochus_BUSCO/short_summary.specific.sauropsida_odb10.Oocatochus_BUSCO.txt')
list.files()
### load BUSCO results
# read as lines
busco <- cogeqc::read_busco('Rdata/busco/')
print(busco)
# plot
plot_busco(busco)
devtools::install_github("tbenavi1/genomescope2.0")
library(ggplot2)
# plot
plot_busco(busco) +
theme(axis.text = element_text(size 14))
# plot
plot_busco(busco) +
theme(axis.text = element_text(size = 14))
# plot
plot_busco(busco) +
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 18))
# clean working environment
rm(list = ls(all.names = T))
gc()
# clean working environment
rm(list = ls(all.names = T))
gc()
# load packages
library(ggplot2)
# load histogram file
jf_hist <- read.table('Rdata/jellyfish/Oocatochus_rufodorsatus_kmer.histo')
print(jf_hist)
head(jf_hist)
# fix column names
colnames(jf_hist) = c('Coverage', 'Frequency')
head(jf)
head(jf_hist)
